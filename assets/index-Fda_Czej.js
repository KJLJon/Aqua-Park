import{P as y}from"./phaser-0RJB29YE.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();class X extends y.Scene{constructor(){super({key:"BootScene"})}preload(){const e=this.add.graphics(),t=this.add.graphics(),{width:s,height:i}=this.cameras.main;t.fillStyle(2236962,.8),t.fillRoundedRect(s/2-120,i/2-15,240,30,10);const n=this.add.text(s/2,i/2-40,"Loading...",{fontSize:"20px",color:"#ffffff"}).setOrigin(.5);this.load.on("progress",a=>{e.clear(),e.fillStyle(46296,1),e.fillRoundedRect(s/2-115,i/2-10,230*a,20,8);const r=document.getElementById("progress-bar"),c=document.getElementById("progress-text");r&&(r.style.width=`${Math.floor(a*100)}%`),c&&(c.textContent=`${Math.floor(a*100)}%`)}),this.load.on("complete",()=>{e.destroy(),t.destroy(),n.destroy();const a=document.getElementById("install-progress");a&&a.classList.add("hidden")}),this.generatePlaceholderAssets()}create(){this.scene.start("MenuScene")}generatePlaceholderAssets(){const e=this.add.graphics();e.setVisible(!1),this.generatePlayerTextures(e),e.clear(),e.fillStyle(46296,1),e.fillRect(0,0,64,64),e.fillStyle(38599,1),e.fillRect(0,0,64,4),e.fillRect(0,60,64,4),e.lineStyle(1,4770532,.5);for(let t=0;t<64;t+=16)e.lineBetween(t,0,t,64);e.generateTexture("slide_tile",64,64),e.clear(),e.fillStyle(9494767,1),e.fillRect(0,0,64,64),e.fillStyle(11397364,.6);for(let t=0;t<5;t++)e.fillEllipse(10+t*12,32,8,4);e.generateTexture("water_tile",64,64),e.clear(),e.fillStyle(16556817,1),e.fillTriangle(0,64,64,64,32,0),e.generateTexture("ramp",64,64),e.clear(),e.fillStyle(9127187,1),e.fillCircle(16,16,14),e.fillStyle(6636321,1),e.fillRect(4,14,24,4),e.generateTexture("barrel",32,32),e.clear(),e.lineStyle(4,16739179,1),e.strokeCircle(16,16,12),e.generateTexture("ring",32,32),e.clear(),e.fillStyle(16729344,1),e.fillCircle(16,16,14),e.fillStyle(16737095,1),e.fillCircle(16,16,8),e.generateTexture("bumper",32,32),e.clear(),e.fillStyle(16766720,1),e.beginPath();for(let t=0;t<5;t++){const s=t*2*Math.PI/5-Math.PI/2,i=s+Math.PI/5;e.lineTo(16+Math.cos(s)*14,16+Math.sin(s)*14),e.lineTo(16+Math.cos(i)*7,16+Math.sin(i)*7)}e.closePath(),e.fillPath(),e.generateTexture("powerup_speed",32,32),e.clear(),e.fillStyle(5227511,1),e.fillCircle(16,16,14),e.fillStyle(11789820,.5),e.fillCircle(16,16,10),e.generateTexture("powerup_shield",32,32),e.clear(),e.fillStyle(7798531,1),e.fillTriangle(16,2,2,30,30,30),e.generateTexture("powerup_jump",32,32),e.clear(),e.fillStyle(30646,1),e.fillRoundedRect(0,0,256,128,20),e.fillStyle(46296,.7),e.fillRoundedRect(10,10,236,108,15),e.generateTexture("pool",256,128),e.clear(),e.fillStyle(11397364,1),e.fillCircle(4,4,4),e.generateTexture("splash_particle",8,8),e.clear(),e.fillStyle(16777215,.6),e.fillRect(0,0,2,16),e.generateTexture("speed_line",2,16),e.clear(),e.fillStyle(16739179,1),e.fillRect(0,0,6,6),e.generateTexture("confetti",6,6),e.clear(),e.fillStyle(30646,1),e.fillRoundedRect(0,0,80,80,15),e.fillStyle(46296,1),e.fillRoundedRect(4,4,72,72,12),e.generateTexture("btn_base",80,80),e.clear(),e.fillStyle(16777215,1),e.fillTriangle(50,10,50,60,15,35),e.generateTexture("arrow_left",64,64),e.clear(),e.fillStyle(16777215,1),e.fillTriangle(14,10,14,60,49,35),e.generateTexture("arrow_right",64,64),e.clear(),e.fillStyle(16777215,1),e.fillTriangle(32,8,8,56,56,56),e.generateTexture("jump_icon",64,64),e.clear(),e.fillStyle(8900331,1),e.fillRect(0,0,390,256),e.fillStyle(16777215,.4),e.fillEllipse(80,60,60,20),e.fillEllipse(200,40,80,25),e.fillEllipse(300,80,50,15),e.generateTexture("bg_sky",390,256),e.clear(),e.fillStyle(2976335,1),e.fillTriangle(0,200,100,50,200,200),e.fillTriangle(120,200,250,30,390,200),e.fillStyle(4231532,1),e.fillTriangle(50,200,180,80,320,200),e.generateTexture("bg_mountains",390,200),e.clear(),e.fillStyle(38599,1),e.fillRect(0,0,16,64),e.fillStyle(4770532,1),e.fillRect(4,0,8,64),e.generateTexture("side_rail",16,64),e.clear(),e.lineStyle(3,5227511,.7),e.strokeCircle(20,20,18),e.generateTexture("shield_effect",40,40),e.clear(),e.fillStyle(0,.5),e.fillRoundedRect(0,0,60,120,5),e.generateTexture("minimap_bg",60,120),e.destroy()}generatePlayerTextures(e){[16739179,5164484,16770669,9822675,15958401,11179738,16564041,3065014].forEach((s,i)=>{e.clear(),e.fillStyle(s,1),e.fillCircle(20,16,12),e.fillStyle(s,.8),e.fillEllipse(20,32,20,12),e.fillStyle(16777215,.9),e.fillEllipse(20,36,28,8),e.lineStyle(2,s,1),e.strokeEllipse(20,36,28,8),e.fillStyle(0,1),e.fillCircle(16,14,2),e.fillCircle(24,14,2),e.lineStyle(1,0,1),e.beginPath(),e.arc(20,18,4,0,Math.PI,!1),e.strokePath(),e.generateTexture(`player_${i}`,40,48)})}}const v={masterVolume:.8,musicVolume:.6,sfxVolume:.8,muted:!1,controlScheme:"buttons",quality:"medium",botCount:7,matchLength:45,tiltEnabled:!1},b={totalRuns:0,totalWins:0,bestTime:999999,totalScore:0,achievements:[],unlockedSkins:[0]},_=[16739179,5164484,16770669,9822675,15958401,11179738,16564041,3065014],I={STATS:"aquapark_stats",SETTINGS:"aquapark_settings",REPLAYS_INDEX:"aquapark_replays_index",REPLAY_PREFIX:"aquapark_replay_"};class E{static async saveStats(e){try{localStorage.setItem(I.STATS,JSON.stringify(e))}catch{}}static async loadStats(){try{const e=localStorage.getItem(I.STATS);if(e)return{...b,...JSON.parse(e)}}catch{}return{...b}}static async saveSettings(e){try{localStorage.setItem(I.SETTINGS,JSON.stringify(e))}catch{}}static async loadSettings(){try{const e=localStorage.getItem(I.SETTINGS);if(e)return{...v,...JSON.parse(e)}}catch{}return{...v}}static async saveReplay(e,t){try{localStorage.setItem(I.REPLAY_PREFIX+e,JSON.stringify(t));const s=await this.listReplays(),i={id:e,date:Date.now(),mode:t.mode,score:0,position:0,duration:t.frames.length/60};s.unshift(i),s.length>20&&s.splice(20).forEach(a=>{try{localStorage.removeItem(I.REPLAY_PREFIX+a.id)}catch{}}),localStorage.setItem(I.REPLAYS_INDEX,JSON.stringify(s))}catch{}}static async loadReplay(e){try{const t=localStorage.getItem(I.REPLAY_PREFIX+e);if(t)return JSON.parse(t)}catch{}return null}static async listReplays(){try{const e=localStorage.getItem(I.REPLAYS_INDEX);if(e)return JSON.parse(e)}catch{}return[]}static async deleteReplay(e){try{localStorage.removeItem(I.REPLAY_PREFIX+e);const s=(await this.listReplays()).filter(i=>i.id!==e);localStorage.setItem(I.REPLAYS_INDEX,JSON.stringify(s))}catch{}}static async clearAll(){try{const e=[];for(let t=0;t<localStorage.length;t++){const s=localStorage.key(t);s&&s.startsWith("aquapark_")&&e.push(s)}e.forEach(t=>localStorage.removeItem(t))}catch{}}static async getStorageUsage(){try{let e=0;for(let t=0;t<localStorage.length;t++){const s=localStorage.key(t);if(s&&s.startsWith("aquapark_")){const i=localStorage.getItem(s);i&&(e+=i.length*2)}}return e}catch{return 0}}}class U extends y.Scene{constructor(){super({key:"MenuScene"})}async create(){this.settings=await E.loadSettings();const{width:e,height:t}=this.cameras.main,s=this.add.graphics();s.fillGradientStyle(30646,30646,46296,9494767,1),s.fillRect(0,0,e,t),this.createWaterAnimation(e,t);const i={fontSize:"48px",fontFamily:"Arial, sans-serif",color:"#ffffff",stroke:"#0077B6",strokeThickness:6,shadow:{offsetX:3,offsetY:3,color:"#003566",blur:8,fill:!0}},n=this.add.text(e/2,80,"AQUA PARK",i).setOrigin(.5);this.tweens.add({targets:n,y:90,duration:1500,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),this.add.text(e/2,130,"Water Slide Racing",{fontSize:"18px",fontFamily:"Arial, sans-serif",color:"#CAF0F8"}).setOrigin(.5),[{label:"Classic Race",mode:"classic",y:240},{label:"Time Trial",mode:"timeTrial",y:320},{label:"Chaos Mode",mode:"chaos",y:400},{label:"Custom Game",mode:"custom",y:480}].forEach(({label:c,mode:o,y:u})=>{this.createMenuButton(e/2,u,c,()=>{this.scene.start("GameScene",{mode:o,settings:this.settings})})}),this.createSmallButton(e/2-80,600,"Settings",()=>{this.scene.start("SettingsScene")}),this.createSmallButton(e/2+80,600,"Replays",()=>{this.scene.start("ReplayScene",{action:"list"})});const r=await E.loadStats();this.add.text(e/2,700,`Races: ${r.totalRuns}  Wins: ${r.totalWins}`,{fontSize:"14px",fontFamily:"Arial, sans-serif",color:"#CAF0F8"}).setOrigin(.5),this.add.text(e/2,t-20,"v1.0.0",{fontSize:"10px",color:"#CAF0F8",fontFamily:"Arial, sans-serif"}).setOrigin(.5)}createMenuButton(e,t,s,i){const n=this.add.graphics();n.fillStyle(30646,.9),n.fillRoundedRect(e-120,t-25,240,50,15),n.lineStyle(2,13299960,1),n.strokeRoundedRect(e-120,t-25,240,50,15);const a=this.add.text(e,t,s,{fontSize:"22px",fontFamily:"Arial, sans-serif",color:"#ffffff"}).setOrigin(.5),r=this.add.zone(e,t,240,50).setInteractive();r.on("pointerdown",()=>{this.tweens.add({targets:[n,a],scaleX:.95,scaleY:.95,duration:100,yoyo:!0,onComplete:i})}),r.on("pointerover",()=>{n.clear(),n.fillStyle(38599,.95),n.fillRoundedRect(e-120,t-25,240,50,15),n.lineStyle(2,16777215,1),n.strokeRoundedRect(e-120,t-25,240,50,15)}),r.on("pointerout",()=>{n.clear(),n.fillStyle(30646,.9),n.fillRoundedRect(e-120,t-25,240,50,15),n.lineStyle(2,13299960,1),n.strokeRoundedRect(e-120,t-25,240,50,15)})}createSmallButton(e,t,s,i){const n=this.add.graphics();n.fillStyle(13670,.8),n.fillRoundedRect(e-65,t-20,130,40,10),this.add.text(e,t,s,{fontSize:"16px",fontFamily:"Arial, sans-serif",color:"#CAF0F8"}).setOrigin(.5),this.add.zone(e,t,130,40).setInteractive().on("pointerdown",i)}createWaterAnimation(e,t){const s=t-100;for(let i=0;i<3;i++){const n=this.add.graphics();n.fillStyle(9494767,.3+i*.15),n.fillEllipse(e/2,s+i*20,e+40,80),this.tweens.add({targets:n,x:10+i*5,duration:2e3+i*500,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}}}const m={FIXED_DT:1/60,LANE_WIDTH:50,FORWARD_ACCEL:120,MAX_FORWARD_SPEED:400,LATERAL_SPEED:280,LATERAL_ACCEL:1200,LATERAL_FRICTION:800,JUMP_DURATION:.5,STUN_DURATION:.4,COLLISION_PUSH:150,COLLISION_RADIUS:20,SPEED_BOOST_MULT:1.5,SPEED_BOOST_DURATION:3,SHIELD_DURATION:4,JUMP_BOOST_MULT:1.5,JUMP_BOOST_DURATION:5,LANDING_BOOST:30,SLIDE_WIDTH:250};class H{constructor(e){this.seed=e}next(){return this.seed=this.seed*1664525+1013904223&4294967295,(this.seed>>>0)/4294967295}nextInt(e,t){return Math.floor(this.next()*(t-e))+e}nextFloat(e,t){return this.next()*(t-e)+e}getSeed(){return this.seed}}function k(l,e,t,s,i,n){return{id:l,name:e,x:t*m.LANE_WIDTH+m.LANE_WIDTH/2,y:0,lane:t,forwardSpeed:0,lateralSpeed:0,distanceTraveled:0,isJumping:!1,jumpTimer:0,stunTimer:0,hasShield:!1,shieldTimer:0,speedBoostTimer:0,jumpBoostTimer:0,isBot:s,botProfile:n,skinIndex:i,score:0,finished:!1,finishTime:0,finishPosition:0}}function B(l,e,t,s){if(l.finished||(l.stunTimer>0&&(l.stunTimer-=s,l.stunTimer<0&&(l.stunTimer=0)),l.shieldTimer>0&&(l.shieldTimer-=s,l.shieldTimer<=0&&(l.hasShield=!1,l.shieldTimer=0)),l.speedBoostTimer>0&&(l.speedBoostTimer-=s,l.speedBoostTimer<0&&(l.speedBoostTimer=0)),l.jumpBoostTimer>0&&(l.jumpBoostTimer-=s,l.jumpBoostTimer<0&&(l.jumpBoostTimer=0)),l.stunTimer>0))return;const i=-t.slope*50,n=l.speedBoostTimer>0?m.SPEED_BOOST_MULT:1;l.forwardSpeed+=(m.FORWARD_ACCEL+i)*s,l.forwardSpeed=Math.min(l.forwardSpeed*n,m.MAX_FORWARD_SPEED),l.forwardSpeed*=t.friction;const a=(e.left?-1:0)+(e.right?1:0);a!==0?(l.lateralSpeed+=a*m.LATERAL_ACCEL*s,l.lateralSpeed=Math.max(-280,Math.min(m.LATERAL_SPEED,l.lateralSpeed))):l.lateralSpeed>0?(l.lateralSpeed-=m.LATERAL_FRICTION*s,l.lateralSpeed<0&&(l.lateralSpeed=0)):l.lateralSpeed<0&&(l.lateralSpeed+=m.LATERAL_FRICTION*s,l.lateralSpeed>0&&(l.lateralSpeed=0)),e.jump&&!l.isJumping&&(l.isJumping=!0,l.jumpTimer=l.jumpBoostTimer>0?m.JUMP_DURATION*m.JUMP_BOOST_MULT:m.JUMP_DURATION),l.isJumping&&(l.jumpTimer-=s,l.jumpTimer<=0&&(l.isJumping=!1,l.jumpTimer=0,l.forwardSpeed+=m.LANDING_BOOST)),l.x+=l.lateralSpeed*s,l.distanceTraveled+=l.forwardSpeed*s;const r=t.lanes*m.LANE_WIDTH/2,c=m.SLIDE_WIDTH/2;l.x=Math.max(c-r+10,Math.min(c+r-10,l.x)),l.lane=Math.floor(l.x/m.LANE_WIDTH),l.lane=Math.max(0,Math.min(t.lanes-1,l.lane))}function V(l,e){if(l.isJumping||e.isJumping||l.finished||e.finished)return!1;const t=l.x-e.x,s=l.distanceTraveled-e.distanceTraveled;return Math.sqrt(t*t+s*s)<m.COLLISION_RADIUS*2}function Y(l,e){if(l.hasShield&&e.hasShield)return;const s=l.x-e.x>0?1:-1;l.hasShield||(l.lateralSpeed+=s*m.COLLISION_PUSH,l.stunTimer=m.STUN_DURATION),e.hasShield||(e.lateralSpeed-=s*m.COLLISION_PUSH,e.stunTimer=m.STUN_DURATION)}function G(l,e){if(!l.hasShield)switch(e){case"barrel":l.forwardSpeed*=.5,l.stunTimer=m.STUN_DURATION*1.5;break;case"ring":l.forwardSpeed*=.7,l.lateralSpeed*=-.5;break;case"bumper":l.lateralSpeed+=(l.x>m.SLIDE_WIDTH/2?1:-1)*m.COLLISION_PUSH*1.5,l.stunTimer=m.STUN_DURATION;break}}function $(l,e){switch(e){case"speed_boost":l.speedBoostTimer=m.SPEED_BOOST_DURATION;break;case"shield":l.hasShield=!0,l.shieldTimer=m.SHIELD_DURATION;break;case"jump_boost":l.jumpBoostTimer=m.JUMP_BOOST_DURATION;break}}function L(l,e,t,s){const i=Math.max(0,(e-l+1)*100),n=Math.max(0,Math.floor((s-t)*10));return i+n}const J={casual:{type:"casual",name:"Casual",targetSpeedFactor:.7,boostSeekRange:100,optimalLineWeight:.3,collisionAggression:.1,collisionAvoidance:.7,jumpFrequency:.2,jumpTimingPrecision:.3,riskTolerance:.2,obstacleAvoidRange:120,steeringJitter:.15,reactionDelay:8,mistakeChance:.1,adaptiveness:.1},aggressive:{type:"aggressive",name:"Aggressive",targetSpeedFactor:.85,boostSeekRange:150,optimalLineWeight:.4,collisionAggression:.8,collisionAvoidance:.2,jumpFrequency:.4,jumpTimingPrecision:.5,riskTolerance:.8,obstacleAvoidRange:80,steeringJitter:.1,reactionDelay:4,mistakeChance:.08,adaptiveness:.3},speedster:{type:"speedster",name:"Speedster",targetSpeedFactor:.95,boostSeekRange:200,optimalLineWeight:.8,collisionAggression:.2,collisionAvoidance:.5,jumpFrequency:.3,jumpTimingPrecision:.8,riskTolerance:.5,obstacleAvoidRange:150,steeringJitter:.05,reactionDelay:2,mistakeChance:.04,adaptiveness:.2},trickster:{type:"trickster",name:"Trickster",targetSpeedFactor:.75,boostSeekRange:120,optimalLineWeight:.3,collisionAggression:.3,collisionAvoidance:.3,jumpFrequency:.8,jumpTimingPrecision:.7,riskTolerance:.7,obstacleAvoidRange:100,steeringJitter:.12,reactionDelay:5,mistakeChance:.06,adaptiveness:.2},adaptive:{type:"adaptive",name:"Adaptive",targetSpeedFactor:.8,boostSeekRange:160,optimalLineWeight:.6,collisionAggression:.4,collisionAvoidance:.4,jumpFrequency:.4,jumpTimingPrecision:.6,riskTolerance:.5,obstacleAvoidRange:130,steeringJitter:.08,reactionDelay:3,mistakeChance:.05,adaptiveness:.9}};class q{constructor(e,t){this.state="race",this.stateTimer=0,this.reactionBuffer=[],this.targetLane=2,this.frameCount=0,this.profile=J[e];for(let s=0;s<this.profile.reactionDelay;s++)this.reactionBuffer.push({left:!1,right:!1,jump:!1})}update(e,t,s,i){this.frameCount++,this.stateTimer++,this.updateState(e,t,s,i);const n=this.generateInput(e,t,s,i);this.reactionBuffer.push(n);const a=this.reactionBuffer.shift();return i.next()<this.profile.steeringJitter&&(i.next()>.5?a.left=!a.left:a.right=!a.right),i.next()<this.profile.mistakeChance/60&&(a.left=i.next()>.5,a.right=!a.left),a}updateState(e,t,s,i){if(e.stunTimer>0){this.state="recover",this.stateTimer=0;return}const n=t.filter(a=>a.id!==e.id&&!a.finished&&Math.abs(a.distanceTraveled-e.distanceTraveled)<100&&Math.abs(a.x-e.x)<m.SLIDE_WIDTH);if(this.profile.adaptiveness>.5){const a=t.find(r=>!r.isBot);a&&a.distanceTraveled>e.distanceTraveled+100&&(this.profile.targetSpeedFactor=Math.min(1,this.profile.targetSpeedFactor+.1),this.profile.riskTolerance=Math.min(1,this.profile.riskTolerance+.1))}this.state==="recover"&&e.stunTimer<=0&&(this.state="race",this.stateTimer=0),n.length>0&&this.profile.collisionAggression>i.next()?(this.state="chase",this.stateTimer=0):this.state==="chase"&&(n.length===0||this.stateTimer>120)&&(this.state="race",this.stateTimer=0),(e.speedBoostTimer>0||e.hasShield||e.jumpBoostTimer>0)&&i.next()<.1&&(this.state="usePowerup",this.stateTimer=0),this.stateTimer>180&&(this.state="race",this.stateTimer=0)}generateInput(e,t,s,i){const n={left:!1,right:!1,jump:!1};switch(this.state){case"race":return this.raceInput(e,s,i);case"avoidObstacle":return this.avoidObstacleInput(e,s,i);case"chase":return this.chaseInput(e,t,i);case"usePowerup":return this.powerupInput(e,i);case"recover":return n}}raceInput(e,t,s){const i={left:!1,right:!1,jump:!1};this.targetLane=this.scoreLanes(e,t,s);const a=this.targetLane*m.LANE_WIDTH+m.LANE_WIDTH/2-e.x,r=10;return a<-r?i.left=!0:a>r&&(i.right=!0),(t.type==="ramp"&&s.next()<this.profile.jumpTimingPrecision||s.next()<this.profile.jumpFrequency/120)&&(i.jump=!0),i}avoidObstacleInput(e,t,s){const i={left:!1,right:!1,jump:!1},r=this.findSafestLane(e,t)*m.LANE_WIDTH+m.LANE_WIDTH/2-e.x;return r<-5?i.left=!0:r>5&&(i.right=!0),s.next()<this.profile.riskTolerance*.5&&(i.jump=!0),i}chaseInput(e,t,s){const i={left:!1,right:!1,jump:!1},n=t.filter(a=>a.id!==e.id&&!a.finished).sort((a,r)=>{const c=Math.abs(a.distanceTraveled-e.distanceTraveled)+Math.abs(a.x-e.x),o=Math.abs(r.distanceTraveled-e.distanceTraveled)+Math.abs(r.x-e.x);return c-o});if(n.length>0){const r=n[0].x-e.x;this.profile.collisionAggression>.5?r<-5?i.left=!0:r>5&&(i.right=!0):r<-5?i.right=!0:r>5&&(i.left=!0)}return s.next()<.02&&(i.jump=!0),i}powerupInput(e,t){const s={left:!1,right:!1,jump:!1};if(e.jumpBoostTimer>0&&t.next()<.05&&(s.jump=!0),e.speedBoostTimer>0){const i=m.SLIDE_WIDTH/2;e.x<i-10?s.right=!0:e.x>i+10&&(s.left=!0)}return s}scoreLanes(e,t,s){const i=t.lanes,n=[];for(let c=0;c<i;c++){let o=0;const u=Math.abs(c-Math.floor(i/2));o+=(i-u)*this.profile.optimalLineWeight*10,t.obstacles.forEach(p=>{p.lane===c&&(o-=20*this.profile.collisionAvoidance)}),t.powerups.forEach(p=>{p.lane===c&&(o+=15*this.profile.boostSeekRange/200)}),o+=s.nextFloat(-5,5),n.push(o)}let a=0,r=-1/0;return n.forEach((c,o)=>{c>r&&(r=c,a=o)}),a}findSafestLane(e,t){const s=t.lanes,i=new Array(s).fill(0);t.obstacles.forEach(r=>{r.lane>=0&&r.lane<s&&(i[r.lane]+=10)});let n=e.lane,a=1/0;return i.forEach((r,c)=>{r<a&&(a=r,n=c)}),n}getState(){return this.state}getProfile(){return{...this.profile}}}function K(){return[F("straight",400,5,.98,-.5,[{type:"barrel",lane:1,position:.5},{type:"barrel",lane:3,position:.7}],[{type:"speed_boost",lane:2,position:.3}]),F("curve_left",300,5,.97,-.6,[{type:"ring",lane:0,position:.4},{type:"bumper",lane:4,position:.6,moving:!0,moveRange:30}],[]),F("ramp",200,5,.99,-1,[],[{type:"jump_boost",lane:2,position:.5}]),F("straight",500,5,.98,-.4,[{type:"barrel",lane:0,position:.2},{type:"barrel",lane:2,position:.3},{type:"barrel",lane:4,position:.4},{type:"bumper",lane:1,position:.6,moving:!0,moveRange:40},{type:"ring",lane:3,position:.8}],[{type:"speed_boost",lane:1,position:.15},{type:"shield",lane:3,position:.5}]),F("narrow",200,3,.96,-.7,[{type:"bumper",lane:1,position:.5,moving:!0,moveRange:20}],[{type:"speed_boost",lane:0,position:.3}]),F("curve_right",350,5,.97,-.5,[{type:"ring",lane:2,position:.3},{type:"barrel",lane:4,position:.5},{type:"barrel",lane:0,position:.7}],[{type:"jump_boost",lane:2,position:.6}]),F("ramp",250,5,.99,-1.2,[],[{type:"speed_boost",lane:2,position:.4}]),F("gap",150,5,.95,-.3,[{type:"ring",lane:1,position:.5},{type:"ring",lane:3,position:.5}],[]),F("straight",600,5,.98,-.8,[{type:"bumper",lane:0,position:.2,moving:!0,moveRange:50},{type:"bumper",lane:4,position:.3,moving:!0,moveRange:50},{type:"barrel",lane:2,position:.5},{type:"ring",lane:1,position:.7},{type:"ring",lane:3,position:.7},{type:"barrel",lane:2,position:.85}],[{type:"speed_boost",lane:2,position:.1},{type:"shield",lane:0,position:.6},{type:"speed_boost",lane:4,position:.9}]),F("splitter",300,5,.97,-.6,[{type:"bumper",lane:2,position:.4}],[{type:"speed_boost",lane:0,position:.5},{type:"speed_boost",lane:4,position:.5}]),F("straight",400,5,.99,-1,[{type:"barrel",lane:1,position:.3},{type:"barrel",lane:3,position:.3}],[{type:"speed_boost",lane:2,position:.5}])]}function Z(l,e,t){const s=[],i=t.matchLength*80;let n=0;const a=["straight","curve_left","curve_right","ramp","narrow","gap"];e==="chaos"&&a.push("splitter","gap","ramp");const r=F("straight",300,5,.98,-.5,[],[{type:"speed_boost",lane:2,position:.5}]);for(s.push(r),n+=300;n<i;){const c=a[l.nextInt(0,a.length)],o=l.nextInt(150,500),u=c==="narrow"?3:5,p=l.nextFloat(.95,.99),h=l.nextFloat(-1.2,-.3),f=[],d=e==="chaos"?l.nextInt(2,6):l.nextInt(0,4),S=["barrel","ring","bumper"];for(let T=0;T<d;T++)f.push({type:S[l.nextInt(0,S.length)],lane:l.nextInt(0,u),position:l.nextFloat(.1,.9),moving:e==="chaos"?l.next()>.5:l.next()>.8,moveRange:l.nextInt(20,50)});const g=[],x=l.nextInt(0,3),A=["speed_boost","shield","jump_boost"];for(let T=0;T<x;T++)g.push({type:A[l.nextInt(0,A.length)],lane:l.nextInt(0,u),position:l.nextFloat(.1,.9)});s.push(F(c,o,u,p,h,f,g)),n+=o}return s.push(F("straight",200,5,.99,-.8,[],[])),s}function F(l,e,t,s,i,n,a){return{type:l,length:e,lanes:t,friction:s,slope:i,obstacles:n,powerups:a}}class Q{constructor(e,t,s){this.input={left:!1,right:!1,jump:!1},this.swipeStartX=0,this.swipeStartY=0,this.swipeThreshold=30,this.swipeDeadzone=10,this.tiltBaseline=0,this.tiltSensitivity=15,this.scene=e,this.scheme=t,this.tiltEnabled=s,this.setupKeyboard(),t==="buttons"?this.setupButtons():t==="swipe"&&this.setupSwipe(),s&&this.setupTilt()}getInput(){var e,t;return this.cursors&&(this.cursors.left.isDown&&(this.input.left=!0),this.cursors.right.isDown&&(this.input.right=!0),this.cursors.left.isUp&&this.scheme!=="tilt"&&this.scheme!=="buttons"&&(this.input.left=!1),this.cursors.right.isUp&&this.scheme!=="tilt"&&this.scheme!=="buttons"&&(this.input.right=!1)),(e=this.spaceKey)!=null&&e.isDown&&(this.input.jump=!0),(t=this.spaceKey)!=null&&t.isUp&&this.scheme!=="buttons"&&(this.input.jump=!1),{...this.input}}setupKeyboard(){this.scene.input.keyboard&&(this.cursors=this.scene.input.keyboard.createCursorKeys(),this.spaceKey=this.scene.input.keyboard.addKey(y.Input.Keyboard.KeyCodes.SPACE))}setupButtons(){const{width:e,height:t}=this.scene.cameras.main,s=80,i=15,n=t-i-s/2,a=s*1.4;this.leftBtn=this.createButton(i+s/2,n,s,"arrow_left"),this.leftBtn.setScrollFactor(0).setDepth(950);const r=this.scene.add.zone(i+s/2,n,a,a).setInteractive().setScrollFactor(0).setDepth(951);r.on("pointerdown",()=>{this.input.left=!0}),r.on("pointerup",()=>{this.input.left=!1}),r.on("pointerout",()=>{this.input.left=!1}),this.rightBtn=this.createButton(i+s*1.9,n,s,"arrow_right"),this.rightBtn.setScrollFactor(0).setDepth(950);const c=this.scene.add.zone(i+s*1.9,n,a,a).setInteractive().setScrollFactor(0).setDepth(951);c.on("pointerdown",()=>{this.input.right=!0}),c.on("pointerup",()=>{this.input.right=!1}),c.on("pointerout",()=>{this.input.right=!1}),this.jumpBtn=this.createButton(e-i-s/2,n,s,"jump_icon"),this.jumpBtn.setScrollFactor(0).setDepth(950);const o=this.scene.add.zone(e-i-s/2,n,a,a).setInteractive().setScrollFactor(0).setDepth(951);o.on("pointerdown",()=>{this.input.jump=!0}),o.on("pointerup",()=>{this.input.jump=!1}),o.on("pointerout",()=>{this.input.jump=!1})}createButton(e,t,s,i){const n=this.scene.add.container(e,t),a=this.scene.add.graphics();a.fillStyle(30646,.6),a.fillRoundedRect(-s/2,-s/2,s,s,15),a.lineStyle(2,13299960,.5),a.strokeRoundedRect(-s/2,-s/2,s,s,15),n.add(a);const r=this.scene.add.sprite(0,0,i);return r.setDisplaySize(s*.5,s*.5),n.add(r),n}setupSwipe(){this.scene.input.on("pointerdown",n=>{this.swipeStartX=n.x,this.swipeStartY=n.y}),this.scene.input.on("pointermove",n=>{if(!n.isDown)return;const a=n.x-this.swipeStartX,r=n.y-this.swipeStartY;Math.abs(a)>this.swipeDeadzone?(this.input.left=a<-this.swipeThreshold,this.input.right=a>this.swipeThreshold):(this.input.left=!1,this.input.right=!1),r<-this.swipeThreshold*1.5&&(this.input.jump=!0)}),this.scene.input.on("pointerup",()=>{this.input.left=!1,this.input.right=!1,this.input.jump=!1});const{width:e,height:t}=this.scene.cameras.main;this.createButton(e-50,t-60,60,"jump_icon").setScrollFactor(0).setDepth(950);const i=this.scene.add.zone(e-50,t-60,60,60).setInteractive().setScrollFactor(0).setDepth(951);i.on("pointerdown",()=>{this.input.jump=!0}),i.on("pointerup",()=>{this.input.jump=!1})}setupTilt(){if("DeviceOrientationEvent"in window){const e=DeviceOrientationEvent.requestPermission;typeof e=="function"?e().then(t=>{t==="granted"&&this.addTiltListener()}).catch(()=>{}):this.addTiltListener()}}addTiltListener(){let e=!1;window.addEventListener("deviceorientation",t=>{if(t.gamma===null)return;e||(this.tiltBaseline=t.gamma,e=!0);const s=t.gamma-this.tiltBaseline;s<-this.tiltSensitivity?(this.input.left=!0,this.input.right=!1):s>this.tiltSensitivity?(this.input.left=!1,this.input.right=!0):(this.input.left=!1,this.input.right=!1)})}destroy(){var e,t,s;(e=this.leftBtn)==null||e.destroy(),(t=this.rightBtn)==null||t.destroy(),(s=this.jumpBtn)==null||s.destroy()}}class C{constructor(){this.audioContext=null,this.settings=null,this.musicOscillator=null,this.musicGain=null,this.isMusicPlaying=!1}static getInstance(){return C.instance||(C.instance=new C),C.instance}getContext(){if(!this.audioContext)try{this.audioContext=new(window.AudioContext||window.webkitAudioContext)}catch{return null}return this.audioContext}applySettings(e){if(this.settings=e,this.musicGain&&this.audioContext){const t=e.muted?0:e.masterVolume*e.musicVolume;this.musicGain.gain.setValueAtTime(t*.1,this.audioContext.currentTime)}}playMusic(){var t;if(this.isMusicPlaying)return;const e=this.getContext();if(!(!e||(t=this.settings)!=null&&t.muted))try{this.musicGain=e.createGain();const s=this.settings?this.settings.masterVolume*this.settings.musicVolume:.3;this.musicGain.gain.setValueAtTime(s*.1,e.currentTime),this.musicGain.connect(e.destination),this.musicOscillator=e.createOscillator(),this.musicOscillator.type="sine",this.musicOscillator.frequency.setValueAtTime(440,e.currentTime);const i=[440,494,523,587,659,587,523,494],n=.3;i.forEach((r,c)=>{const o=e.currentTime+c*n;this.musicOscillator.frequency.setValueAtTime(r,o)});const a=i.length*n;this.musicOscillator.connect(this.musicGain),this.musicOscillator.start(),this.scheduleLoop(e,i,n,a),this.isMusicPlaying=!0}catch{}}scheduleLoop(e,t,s,i){const n=()=>{!this.isMusicPlaying||!this.musicOscillator||(t.forEach((a,r)=>{const c=e.currentTime+r*s;try{this.musicOscillator.frequency.setValueAtTime(a,c)}catch{}}),setTimeout(n,i*1e3))};setTimeout(n,i*1e3)}stopMusic(){if(this.musicOscillator){try{this.musicOscillator.stop()}catch{}this.musicOscillator=null}this.isMusicPlaying=!1}playSfx(e){var i;const t=this.getContext();if(!t||(i=this.settings)!=null&&i.muted)return;const s=this.settings?this.settings.masterVolume*this.settings.sfxVolume:.5;if(!(s<=0))try{const n=t.createOscillator(),a=t.createGain();switch(a.gain.setValueAtTime(s*.2,t.currentTime),a.connect(t.destination),n.connect(a),e){case"jump":n.type="sine",n.frequency.setValueAtTime(600,t.currentTime),n.frequency.exponentialRampToValueAtTime(1200,t.currentTime+.15),a.gain.exponentialRampToValueAtTime(.001,t.currentTime+.2),n.start(),n.stop(t.currentTime+.2);break;case"collision":n.type="sawtooth",n.frequency.setValueAtTime(200,t.currentTime),n.frequency.exponentialRampToValueAtTime(80,t.currentTime+.15),a.gain.exponentialRampToValueAtTime(.001,t.currentTime+.2),n.start(),n.stop(t.currentTime+.2);break;case"splash":n.type="sine",n.frequency.setValueAtTime(800,t.currentTime),n.frequency.exponentialRampToValueAtTime(200,t.currentTime+.4),a.gain.exponentialRampToValueAtTime(.001,t.currentTime+.5),n.start(),n.stop(t.currentTime+.5);break;case"powerup":n.type="sine",n.frequency.setValueAtTime(523,t.currentTime),n.frequency.setValueAtTime(659,t.currentTime+.1),n.frequency.setValueAtTime(784,t.currentTime+.2),a.gain.exponentialRampToValueAtTime(.001,t.currentTime+.3),n.start(),n.stop(t.currentTime+.3);break;case"win":n.type="sine",[523,659,784,1047].forEach((c,o)=>{n.frequency.setValueAtTime(c,t.currentTime+o*.15)}),a.gain.exponentialRampToValueAtTime(.001,t.currentTime+.8),n.start(),n.stop(t.currentTime+.8);break;case"click":n.type="sine",n.frequency.setValueAtTime(800,t.currentTime),a.gain.exponentialRampToValueAtTime(.001,t.currentTime+.05),n.start(),n.stop(t.currentTime+.05);break}}catch{}}}const ee=450,P=200,O=200,w=30,te=1200,W=5;class ie extends y.Scene{constructor(){super({key:"GameScene"}),this.players=[],this.track=[],this.totalTrackLength=0,this.elapsedTime=0,this.tickCount=0,this.gameOver=!1,this.finishCount=0,this.isCountingDown=!0,this.renderSegs=[],this.worldObjects=[],this.playerInput={left:!1,right:!1,jump:!1},this.botControllers=new Map,this.replayFrames=[],this.isReplay=!1,this.replayTick=0}init(e){this.mode=e.mode||"classic",this.settings=e.settings||v,this.isReplay=!!e.replay,this.replayData=e.replay,this.players=[],this.botControllers.clear(),this.replayFrames=[],this.elapsedTime=0,this.tickCount=0,this.gameOver=!1,this.finishCount=0,this.replayTick=0,this.isCountingDown=!0,this.playerInput={left:!1,right:!1,jump:!1},this.renderSegs=[],this.worldObjects=[]}create(){var s;const{width:e,height:t}=this.cameras.main;this.seed=this.isReplay&&this.replayData?this.replayData.seed:Date.now(),this.rng=new H(this.seed),this.mode==="classic"||this.isReplay&&((s=this.replayData)==null?void 0:s.mode)==="classic"?this.track=K():this.track=Z(this.rng,this.mode,this.settings),this.totalTrackLength=this.track.reduce((i,n)=>i+n.length,0),this.buildRenderSegments(),this.buildWorldObjects(),this.createPlayers(),this.gfx=this.add.graphics(),this.createHUD(e),this.isReplay||(this.controls=new Q(this,this.settings.controlScheme,this.settings.tiltEnabled)),this.audioManager=C.getInstance(),this.audioManager.applySettings(this.settings),this.cameras.main.setBackgroundColor(8900331),this.showCountdown()}update(e,t){if(this.isCountingDown||this.gameOver)return;const s=m.FIXED_DT;if(this.elapsedTime+=s,this.tickCount++,!this.isReplay)this.playerInput=this.controls.getInput(),this.replayFrames.push({tick:this.tickCount,inputs:{...this.playerInput}});else if(this.replayData){const a=this.replayData.frames[this.replayTick];a&&(this.playerInput=a.inputs,this.replayTick++)}const i=a=>{let r=0;for(const c of this.track)if(r+=c.length,a<r)return c;return this.track[this.track.length-1]},n=this.players.find(a=>!a.isBot);B(n,this.playerInput,i(n.distanceTraveled),s),this.players.filter(a=>a.isBot&&!a.finished).forEach(a=>{const r=this.botControllers.get(a.id);if(r){const c=r.update(a,this.players,i(a.distanceTraveled),this.rng);B(a,c,i(a.distanceTraveled),s)}});for(let a=0;a<this.players.length;a++)for(let r=a+1;r<this.players.length;r++)V(this.players[a],this.players[r])&&(Y(this.players[a],this.players[r]),this.audioManager.playSfx("collision"),(!this.players[a].isBot||!this.players[r].isBot)&&this.cameras.main.shake(100,.005));if(this.checkWorldObjectCollisions(n),this.players.forEach(a=>{!a.finished&&a.distanceTraveled>=this.totalTrackLength&&(this.finishCount++,a.finished=!0,a.finishTime=this.elapsedTime,a.finishPosition=this.finishCount,a.score=L(this.finishCount,this.players.length,this.elapsedTime,this.settings.matchLength),a.isBot||this.audioManager.playSfx("splash"))}),this.elapsedTime>=this.settings.matchLength||this.players.every(a=>a.finished)){this.players.forEach(a=>{a.finished||(this.finishCount++,a.finished=!0,a.finishTime=this.elapsedTime,a.finishPosition=this.finishCount,a.score=L(this.finishCount,this.players.length,this.elapsedTime,this.settings.matchLength))}),this.endGame();return}this.render3D(n),this.updateHUD(n)}buildRenderSegments(){this.renderSegs=[];let e=0,t=0,s=0;const i={straight:0,curve_left:-3,curve_right:3,ramp:0,gap:0,splitter:0,narrow:0};for(;e<this.totalTrackLength+O*w;){for(;t<this.track.length-1&&e>=s+this.track[t].length;)s+=this.track[t].length,t++;const n=this.track[Math.min(t,this.track.length-1)],a=n.length>0?(e-s)/n.length:0,r=i[n.type]||0,c=n.slope||0,o=Math.floor(e/w)%2===0,u=o?46296:38599,p=o?4770532:30646;this.renderSegs.push({worldZ:e,screenX:0,screenY:0,screenW:0,scale:0,curve:r,slope:c,color1:u,color2:p,clip:0,segmentIndex:t,segFraction:a}),e+=w}}buildWorldObjects(){this.worldObjects=[];let e=0;this.track.forEach(t=>{t.obstacles.forEach(s=>{const i=s.lane/(t.lanes-1)*2-1;this.worldObjects.push({distance:e+s.position*t.length,laneOffset:i*.8,type:"obstacle",collected:!1,obstacleType:s.type})}),t.powerups.forEach(s=>{const i=s.lane/(t.lanes-1)*2-1;this.worldObjects.push({distance:e+s.position*t.length,laneOffset:i*.8,type:"powerup",collected:!1,powerupType:s.type})}),e+=t.length})}createPlayers(){var n;const e=this.settings.botCount,t=((n=this.track[0])==null?void 0:n.lanes)||5,s=k("player","You",Math.floor(t/2),!1,0);this.players.push(s);const i=["casual","aggressive","speedster","trickster","adaptive"];for(let a=0;a<e;a++){const r=a%t,c=i[a%i.length],o=k(`bot_${a}`,`Bot ${a+1}`,r,!0,(a+1)%8,c);this.players.push(o),this.botControllers.set(o.id,new q(c,this.rng))}}checkWorldObjectCollisions(e){var s;const t=((s=this.track[0])==null?void 0:s.lanes)||5;this.worldObjects.forEach(i=>{i.collected||this.players.forEach(n=>{if(n.finished||n.isJumping||Math.abs(n.distanceTraveled-i.distance)>30)return;const r=t*m.LANE_WIDTH/2,c=m.SLIDE_WIDTH/2,o=(n.x-c)/r;Math.abs(o-i.laneOffset)>.35||(i.type==="obstacle"&&i.obstacleType?(n.hasShield||G(n,i.obstacleType),i.collected=!0,n.isBot||this.audioManager.playSfx("collision")):i.type==="powerup"&&i.powerupType&&($(n,i.powerupType),i.collected=!0,n.isBot||this.audioManager.playSfx("powerup")))})})}render3D(e){const{width:t,height:s}=this.cameras.main,i=this.gfx;i.clear(),this.drawSky(i,t,s);const n=e.distanceTraveled;this.getPlayerScreenX(e);const a=Math.max(0,Math.floor(n/w)),r=Math.min(this.renderSegs.length-1,a+O);let c=s,o=0,u=0;for(let p=a;p<=r;p++){const h=this.renderSegs[p];if(!h)continue;const f=n,d=h.worldZ-f;if(d<=0)continue;const S=P/d;h.scale=S,h.screenX=t/2+o*S*t,h.screenY=s/2-ee*S+u*S*s,h.screenW=te/2*S,h.clip=c,o+=h.curve*w*4e-4,u+=h.slope*w*3e-4}for(let p=r;p>a;p--){const h=this.renderSegs[p],f=this.renderSegs[p-1];if(!h||!f||h.scale<=0||f.scale<=0||f.screenY>=h.clip)continue;const d=Math.max(0,f.screenY),S=Math.min(s,h.screenY);if(d>=S)continue;i.fillStyle(p%2===0?1092176:39236,1),i.fillRect(0,d,t,S-d),this.drawTrapezoid(i,f.screenX,f.screenW,d,h.screenX,h.screenW,S,h.color1);const g=f.screenW*.02,x=h.screenW*.02;if(this.drawTrapezoid(i,f.screenX,g,d,h.screenX,x,S,16777215),p%4<2)for(let R=1;R<W;R++){const M=R/W*2-1,D=f.screenW*.01,N=h.screenW*.01,j=f.screenX+M*f.screenW,z=h.screenX+M*h.screenW;this.drawTrapezoid(i,j,D,d,z,N,S,4770532)}const A=f.screenW*.08,T=h.screenW*.08;if(this.drawTrapezoid(i,f.screenX-f.screenW-A/2,A,d,h.screenX-h.screenW-T/2,T,S,h.color2),this.drawTrapezoid(i,f.screenX+f.screenW+A/2,A,d,h.screenX+h.screenW+T/2,T,S,h.color2),p%6===0){const R=.15+Math.sin(this.elapsedTime*3+p)*.1;i.fillStyle(11397364,R),this.fillTrapezoid(i,f.screenX,f.screenW*.9,d,h.screenX,h.screenW*.9,S)}}this.drawWorldObjects(i,e,a,r,t,s),this.drawPlayers(i,e,t,s),this.drawFinishLine(i,e,t,s),this.drawWaterSplash(i,e,t,s)}drawSky(e,t,s){const n=s/2;for(let o=0;o<8;o++){const u=o/8,p=Math.floor(72+101*u),h=Math.floor(202+30*u),f=Math.floor(228+16*u),d=p<<16|h<<8|f;e.fillStyle(d,1),e.fillRect(0,n/8*o,t,n/8+1)}e.fillStyle(16777215,.5);const a=this.elapsedTime*5;e.fillEllipse((80+a)%(t+100)-50,60,70,22),e.fillEllipse((220+a*.7)%(t+100)-50,40,90,28),e.fillEllipse((350+a*.5)%(t+100)-50,80,55,18),e.fillStyle(2976335,1);const r=s*.25,c=s/2-r*.3;e.fillTriangle(0,c+r,t*.25,c,t*.5,c+r),e.fillStyle(4231532,1),e.fillTriangle(t*.3,c+r,t*.6,c-r*.15,t*.9,c+r),e.fillStyle(5420936,1),e.fillTriangle(t*.15,c+r,t*.45,c+r*.3,t*.75,c+r)}drawTrapezoid(e,t,s,i,n,a,r,c){e.fillStyle(c,1),e.fillTriangle(t-s,i,t+s,i,n+a,r),e.fillTriangle(t-s,i,n-a,r,n+a,r)}fillTrapezoid(e,t,s,i,n,a,r){e.fillTriangle(t-s,i,t+s,i,n+a,r),e.fillTriangle(t-s,i,n-a,r,n+a,r)}drawWorldObjects(e,t,s,i,n,a){const r=t.distanceTraveled;this.worldObjects.filter(o=>{if(o.collected)return!1;const u=o.distance-r;return u>0&&u<O*w}).sort((o,u)=>u.distance-o.distance).forEach(o=>{const u=Math.floor(o.distance/w);if(u<s||u>=i||u>=this.renderSegs.length)return;const p=this.renderSegs[u];if(!p||p.scale<=0||p.screenY>a||p.screenY<0)return;const h=p.screenX+o.laneOffset*p.screenW,f=p.screenY,d=p.scale*250;if(!(d<2)){if(o.type==="obstacle"){const g={barrel:13382400,ring:16720418,bumper:16737792}[o.obstacleType||"barrel"]||13382400,x=.4+Math.sin(this.elapsedTime*6+o.distance)*.2;e.fillStyle(16711680,x),e.fillCircle(h,f-d/2,d*2),e.fillStyle(g,1),e.fillCircle(h,f-d/2,d),d>4&&(e.lineStyle(Math.max(1,d*.2),16776960,.9),e.lineBetween(h-d*.5,f-d,h+d*.5,f),e.lineBetween(h+d*.5,f-d,h-d*.5,f)),e.fillStyle(16777215,.3),e.fillCircle(h-d*.3,f-d*.8,d*.3)}else if(o.type==="powerup"){const g={speed_boost:16766720,shield:5227511,jump_boost:7798531}[o.powerupType||"speed_boost"]||16766720,x=1.5+Math.sin(this.elapsedTime*5+o.distance*.1)*.5;if(e.fillStyle(g,.35),e.fillCircle(h,f-d/2,d*x*1.2),e.fillStyle(g,1),e.fillCircle(h,f-d/2,d),e.fillStyle(16777215,.9),e.fillCircle(h,f-d*.8,d*.35),d>4){const A=this.elapsedTime*3;for(let T=0;T<4;T++){const R=A+T*Math.PI/2,M=h+Math.cos(R)*d*1.3,D=f-d/2+Math.sin(R)*d*1.3;e.fillStyle(16777215,.6),e.fillCircle(M,D,d*.15)}}}}})}drawPlayers(e,t,s,i){var u;const n=t.distanceTraveled,r=(((u=this.track[0])==null?void 0:u.lanes)||5)*m.LANE_WIDTH/2,c=m.SLIDE_WIDTH/2;[...this.players].filter(p=>!p.finished||Math.abs(p.distanceTraveled-n)<O*w).sort((p,h)=>h.distanceTraveled-p.distanceTraveled).forEach(p=>{const h=p.distanceTraveled-n;let f,d,S;if(p.id===t.id)f=s/2+this.getPlayerScreenX(t)*s*.3,d=i*.82,S=.5,p.isJumping&&(d-=20);else{if(h<=-50||h>O*w)return;const A=Math.max(10,h+50);if(S=P/A,S<.03)return;const T=Math.floor(p.distanceTraveled/w),R=this.renderSegs[T];if(!R)return;const M=(p.x-c)/r;if(f=R.screenX+M*R.screenW,d=R.screenY,d<0||d>i)return;p.isJumping&&(d-=15*S*20)}const g=S*200;if(g<3)return;const x=_[p.skinIndex]||16739179;e.fillStyle(16777215,.85),e.fillEllipse(f,d,g*1.4,g*.5),e.lineStyle(Math.max(1,g*.08),x,1),e.strokeEllipse(f,d,g*1.4,g*.5),e.fillStyle(x,1),e.fillEllipse(f,d-g*.5,g*.7,g*.6),e.fillStyle(x,1),e.fillCircle(f,d-g*1,g*.45),g>8&&(e.fillStyle(0,1),e.fillCircle(f-g*.15,d-g*1.05,g*.07),e.fillCircle(f+g*.15,d-g*1.05,g*.07),e.lineStyle(Math.max(1,g*.04),0,1),e.beginPath(),e.arc(f,d-g*.85,g*.15,0,Math.PI,!1),e.strokePath()),p.hasShield&&(e.lineStyle(2,5227511,.6),e.strokeCircle(f,d-g*.5,g*1.2)),p.stunTimer>0&&Math.floor(this.elapsedTime*10)%2===0&&(e.fillStyle(16777215,.4),e.fillCircle(f,d-g*.5,g*.8)),p.speedBoostTimer>0&&(e.fillStyle(16766720,.3),e.fillEllipse(f,d+g*.3,g*.4,g*1.5)),p.isBot&&g>12})}drawFinishLine(e,t,s,i){const n=this.totalTrackLength-t.distanceTraveled;if(n<=0||n>O*w)return;const a=Math.floor(this.totalTrackLength/w),r=this.renderSegs[a];if(!r||r.screenY<0||r.screenY>i)return;const c=r.screenY,o=r.screenW*2,u=Math.max(3,r.scale*100),p=10,h=o/p;for(let f=0;f<p;f++){const d=r.screenX-o/2+f*h;e.fillStyle(f%2===0?16777215:0,1),e.fillRect(d,c-u,h,u/2),e.fillStyle(f%2===0?0:16777215,1),e.fillRect(d,c-u/2,h,u/2)}}drawWaterSplash(e,t,s,i){if(t.forwardSpeed<m.MAX_FORWARD_SPEED*.1)return;const n=s/2+this.getPlayerScreenX(t)*s*.3,a=i*.87,r=Math.min(1,t.forwardSpeed/m.MAX_FORWARD_SPEED),c=Math.floor(2+r*10);for(let o=0;o<c;o++){const u=-Math.PI/2+(Math.random()-.5)*Math.PI*.8,p=8+Math.random()*30*r,h=n+Math.cos(u)*p,f=a+Math.sin(u)*p*.5,d=1.5+Math.random()*3*r;e.fillStyle(11397364,.5+r*.3),e.fillCircle(h,f,d)}if(e.fillStyle(13299960,.2+r*.15),e.fillEllipse(n,a+5,30+r*40,8+r*6),r>.3){const o=Math.floor(r*10),u=.15+r*.25;e.lineStyle(1,16777215,u);for(let p=0;p<o;p++){const h=p%2===0?-1:1,f=n+h*(30+Math.random()*50),d=i*.5+Math.random()*(i*.35),S=10+r*25;e.lineBetween(f,d,f,d+S)}}}getPlayerScreenX(e){var n;const s=(((n=this.track[0])==null?void 0:n.lanes)||5)*m.LANE_WIDTH/2,i=m.SLIDE_WIDTH/2;return(e.x-i)/s}createHUD(e){this.hudContainer=this.add.container(0,0).setScrollFactor(0).setDepth(900);const t=this.add.graphics();t.fillStyle(0,.5),t.fillRect(0,0,e,50),this.hudContainer.add(t),this.posText=this.add.text(15,12,"#-",{fontSize:"22px",fontFamily:"Arial",color:"#FFD700",fontStyle:"bold"}),this.hudContainer.add(this.posText),this.timeText=this.add.text(e/2,12,"0:00",{fontSize:"18px",fontFamily:"Arial",color:"#FFFFFF"}).setOrigin(.5,0),this.hudContainer.add(this.timeText),this.speedText=this.add.text(e-15,12,"0 km/h",{fontSize:"16px",fontFamily:"Arial",color:"#90E0EF"}).setOrigin(1,0),this.hudContainer.add(this.speedText),this.progressBar=this.add.graphics(),this.hudContainer.add(this.progressBar),this.powerupText=this.add.text(e/2,38,"",{fontSize:"12px",fontFamily:"Arial",color:"#FFD700"}).setOrigin(.5,0),this.hudContainer.add(this.powerupText)}updateHUD(e){const t=this.cameras.main.width,s=this.players.filter(o=>o.distanceTraveled>e.distanceTraveled).length+1;this.posText.setText(`#${s}`),this.posText.setColor(s===1?"#FFD700":s===2?"#C0C0C0":s===3?"#CD7F32":"#FFFFFF");const i=Math.floor(this.elapsedTime/60),n=Math.floor(this.elapsedTime%60),a=Math.floor(this.elapsedTime%1*100);this.timeText.setText(`${i}:${n.toString().padStart(2,"0")}.${a.toString().padStart(2,"0")}`),this.speedText.setText(`${Math.floor(e.forwardSpeed)} km/h`),this.speedText.setColor(e.speedBoostTimer>0?"#FFD700":e.hasShield?"#4FC3F7":"#90E0EF");const r=Math.min(1,e.distanceTraveled/this.totalTrackLength);this.progressBar.clear(),this.progressBar.fillStyle(13670,.8),this.progressBar.fillRoundedRect(10,52,t-20,10,5),this.progressBar.fillStyle(46296,1),this.progressBar.fillRoundedRect(10,52,(t-20)*r,10,5),this.players.forEach(o=>{if(o.isBot&&!o.finished){const u=Math.min(1,o.distanceTraveled/this.totalTrackLength),p=10+(t-20)*u,h=_[o.skinIndex]||16739179;this.progressBar.fillStyle(h,.9),this.progressBar.fillCircle(p,57,4)}});const c=10+(t-20)*r;this.progressBar.fillStyle(16777215,1),this.progressBar.fillCircle(c,57,6),this.progressBar.lineStyle(1,46296,1),this.progressBar.strokeCircle(c,57,6),e.speedBoostTimer>0?(this.powerupText.setText(`SPEED BOOST ${Math.ceil(e.speedBoostTimer)}s`),this.powerupText.setColor("#FFD700")):e.hasShield?(this.powerupText.setText(`SHIELD ${Math.ceil(e.shieldTimer)}s`),this.powerupText.setColor("#4FC3F7")):e.jumpBoostTimer>0?(this.powerupText.setText(`JUMP BOOST ${Math.ceil(e.jumpBoostTimer)}s`),this.powerupText.setColor("#76FF03")):this.powerupText.setText("")}showCountdown(){const{width:e,height:t}=this.cameras.main,s=this.add.text(e/2,t/2-50,"3",{fontSize:"72px",fontFamily:"Arial",color:"#FFD700",stroke:"#003566",strokeThickness:6}).setOrigin(.5).setScrollFactor(0).setDepth(1e3);let i=3;this.time.addEvent({delay:1e3,repeat:3,callback:()=>{i--,i>0?(s.setText(i.toString()),this.tweens.add({targets:s,scaleX:1.5,scaleY:1.5,duration:200,yoyo:!0})):i===0&&(s.setText("GO!"),s.setColor("#76FF03"),this.tweens.add({targets:s,scaleX:2,scaleY:2,alpha:0,duration:500,onComplete:()=>{s.destroy(),this.isCountingDown=!1,this.audioManager.playMusic()}}))}});const n=this.players.find(a=>!a.isBot);this.render3D(n)}async endGame(){if(this.gameOver=!0,this.audioManager.stopMusic(),this.audioManager.playSfx("win"),!this.isReplay){const t={version:1,seed:this.seed,mode:this.mode,settings:this.settings,frames:this.replayFrames,startTime:Date.now(),playerName:"You"},s=this.players.find(a=>!a.isBot),i=`replay_${Date.now()}`;await E.saveReplay(i,t);const n=await E.loadStats();n.totalRuns++,s.finishPosition===1&&n.totalWins++,s.finishTime<n.bestTime&&(n.bestTime=s.finishTime),n.totalScore+=s.score,await E.saveStats(n)}const e=[...this.players].sort((t,s)=>t.finishPosition-s.finishPosition);this.time.delayedCall(1e3,()=>{this.scene.start("ResultsScene",{players:e,mode:this.mode,elapsedTime:this.elapsedTime})})}shutdown(){this.controls&&this.controls.destroy(),this.audioManager.stopMusic()}}function se(l){const e={v:l.version,s:l.seed,m:l.mode,f:l.frames.map(s=>({t:s.tick,i:(s.inputs.left?1:0)|(s.inputs.right?2:0)|(s.inputs.jump?4:0)}))},t=JSON.stringify(e);return btoa(t)}function ne(l){try{const e=atob(l),t=JSON.parse(e);return{version:t.v,seed:t.s,mode:t.m,settings:{},frames:t.f.map(s=>({tick:s.t,inputs:{left:!!(s.i&1),right:!!(s.i&2),jump:!!(s.i&4)}})),startTime:0,playerName:"Replay"}}catch{return null}}class ae extends y.Scene{constructor(){super({key:"ReplayScene"}),this.action="list"}init(e){this.action=e.action||"list",this.replayId=e.replayId}async create(){if(this.action==="play"&&this.replayId){await this.playReplay(this.replayId);return}await this.showReplayList()}async showReplayList(){const{width:e,height:t}=this.cameras.main,s=this.add.graphics();s.fillGradientStyle(13670,13670,30646,46296,1),s.fillRect(0,0,e,t),this.add.text(e/2,40,"REPLAYS",{fontSize:"32px",fontFamily:"Arial",color:"#FFFFFF",stroke:"#003566",strokeThickness:4}).setOrigin(.5);const i=await E.listReplays();if(i.length===0)this.add.text(e/2,t/2,`No replays saved yet.
Play some races first!`,{fontSize:"18px",fontFamily:"Arial",color:"#CAF0F8",align:"center"}).setOrigin(.5);else{let n=100;i.slice(0,10).forEach(a=>{this.createReplayRow(30,n,a,e),n+=60})}this.checkUrlReplay(),this.add.text(e/2,t-60,"Back to Menu",{fontSize:"18px",fontFamily:"Arial",color:"#CAF0F8"}).setOrigin(.5),this.add.zone(e/2,t-60,200,40).setInteractive().on("pointerdown",()=>{this.scene.start("MenuScene")})}createReplayRow(e,t,s,i){const n=this.add.graphics();n.fillStyle(13670,.6),n.fillRoundedRect(e,t,i-60,50,8);const a=new Date(s.date),r=`${a.getMonth()+1}/${a.getDate()} ${a.getHours()}:${a.getMinutes().toString().padStart(2,"0")}`;this.add.text(e+10,t+8,r,{fontSize:"12px",fontFamily:"Arial",color:"#90E0EF"}),this.add.text(e+10,t+28,`${s.mode} - #${s.position}`,{fontSize:"14px",fontFamily:"Arial",color:"#FFFFFF"}),this.add.text(e+180,t+18,`Score: ${s.score}`,{fontSize:"14px",fontFamily:"Arial",color:"#FFD700"});const c=this.add.graphics();c.fillStyle(46296,.9),c.fillRoundedRect(i-110,t+8,60,34,8),this.add.text(i-80,t+25,"Play",{fontSize:"14px",fontFamily:"Arial",color:"#FFFFFF"}).setOrigin(.5),this.add.zone(i-80,t+25,60,34).setInteractive().on("pointerdown",()=>{this.playReplay(s.id)});const o=this.add.graphics();o.fillStyle(13670,.9),o.fillRoundedRect(i-170,t+8,52,34,8),this.add.text(i-144,t+25,"Share",{fontSize:"12px",fontFamily:"Arial",color:"#CAF0F8"}).setOrigin(.5),this.add.zone(i-144,t+25,52,34).setInteractive().on("pointerdown",async()=>{await this.shareReplay(s.id)})}async playReplay(e){const t=await E.loadReplay(e);t&&this.scene.start("GameScene",{mode:t.mode,settings:t.settings,replay:t})}async shareReplay(e){const t=await E.loadReplay(e);if(!t)return;const s=se(t),i=`${window.location.origin}${window.location.pathname}#replay=${s}`;navigator.clipboard?(await navigator.clipboard.writeText(i),this.showToast("Replay link copied!")):this.showToast("Share not available")}checkUrlReplay(){const e=window.location.hash;if(e.startsWith("#replay=")){const t=e.substring(8);try{const s=ne(t);s&&this.scene.start("GameScene",{mode:s.mode,settings:s.settings,replay:s})}catch{}}}showToast(e){const{width:t,height:s}=this.cameras.main,i=this.add.text(t/2,s-120,e,{fontSize:"16px",fontFamily:"Arial",color:"#FFFFFF",backgroundColor:"#003566",padding:{x:12,y:6}}).setOrigin(.5);this.tweens.add({targets:i,alpha:0,y:s-140,duration:2e3,delay:1e3,onComplete:()=>i.destroy()})}}class re extends y.Scene{constructor(){super({key:"SettingsScene"}),this.sliders=new Map}async create(){this.settings=await E.loadSettings();const{width:e,height:t}=this.cameras.main,s=this.add.graphics();s.fillGradientStyle(13670,13670,30646,46296,1),s.fillRect(0,0,e,t),this.add.text(e/2,40,"SETTINGS",{fontSize:"32px",fontFamily:"Arial",color:"#FFFFFF",stroke:"#003566",strokeThickness:4}).setOrigin(.5);let i=100;const n=30;this.addSectionTitle(e/2,i,"Audio"),i+=35,this.addSlider(40,i,"Master Volume",this.settings.masterVolume,a=>{this.settings.masterVolume=a}),i+=50,this.addSlider(40,i,"Music",this.settings.musicVolume,a=>{this.settings.musicVolume=a}),i+=50,this.addSlider(40,i,"SFX",this.settings.sfxVolume,a=>{this.settings.sfxVolume=a}),i+=40,this.addToggle(40,i,"Mute All",this.settings.muted,a=>{this.settings.muted=a}),i+=n+30,this.addSectionTitle(e/2,i,"Controls"),i+=35,this.addOptionSelector(40,i,"Scheme",["buttons","swipe","tilt"],this.settings.controlScheme,a=>{this.settings.controlScheme=a}),i+=40,this.addToggle(40,i,"Tilt Steering",this.settings.tiltEnabled,a=>{this.settings.tiltEnabled=a}),i+=n+30,this.addSectionTitle(e/2,i,"Graphics"),i+=35,this.addOptionSelector(40,i,"Quality",["low","medium","high"],this.settings.quality,a=>{this.settings.quality=a}),i+=n+30,this.addSectionTitle(e/2,i,"Gameplay"),i+=35,this.addSlider(40,i,`Bots: ${this.settings.botCount}`,this.settings.botCount/15,a=>{this.settings.botCount=Math.max(1,Math.round(a*15))}),i+=50,this.addSlider(40,i,`Time: ${this.settings.matchLength}s`,this.settings.matchLength/120,a=>{this.settings.matchLength=Math.max(15,Math.round(a*120))}),this.addButton(e/2-80,t-80,"Save & Back",async()=>{await E.saveSettings(this.settings),C.getInstance().applySettings(this.settings),this.scene.start("MenuScene")}),this.addButton(e/2+80,t-80,"Reset",async()=>{this.settings={...v},await E.saveSettings(this.settings),this.scene.restart()})}addSectionTitle(e,t,s){this.add.text(e,t,s,{fontSize:"18px",fontFamily:"Arial",color:"#FFD700",fontStyle:"bold"}).setOrigin(.5);const i=this.add.graphics();i.lineStyle(1,16766720,.5),i.lineBetween(40,t+12,this.cameras.main.width-40,t+12)}addSlider(e,t,s,i,n){const a=this.cameras.main.width-80;this.add.text(e,t-10,s,{fontSize:"14px",fontFamily:"Arial",color:"#CAF0F8"});const r=this.add.graphics();r.fillStyle(13670,1),r.fillRoundedRect(e,t+8,a,8,4),r.fillStyle(46296,1),r.fillRoundedRect(e,t+8,a*i,8,4);const c=e+a*i,o=this.add.graphics();o.fillStyle(16777215,1),o.fillCircle(0,0,10),o.setPosition(c,t+12);const u=this.add.zone(e+a/2,t+12,a+20,30).setInteractive();u.on("pointerdown",p=>{const h=y.Math.Clamp((p.x-e)/a,0,1);o.setPosition(e+a*h,t+12),r.clear(),r.fillStyle(13670,1),r.fillRoundedRect(e,t+8,a,8,4),r.fillStyle(46296,1),r.fillRoundedRect(e,t+8,a*h,8,4),n(h)}),u.on("pointermove",p=>{if(!p.isDown)return;const h=y.Math.Clamp((p.x-e)/a,0,1);o.setPosition(e+a*h,t+12),r.clear(),r.fillStyle(13670,1),r.fillRoundedRect(e,t+8,a,8,4),r.fillStyle(46296,1),r.fillRoundedRect(e,t+8,a*h,8,4),n(h)})}addToggle(e,t,s,i,n){this.add.text(e,t,s,{fontSize:"14px",fontFamily:"Arial",color:"#CAF0F8"});const a=this.add.graphics(),r=this.add.graphics(),c=u=>{a.clear(),a.fillStyle(u?46296:13670,1),a.fillRoundedRect(280,t-2,50,24,12),r.clear(),r.fillStyle(16777215,1),r.fillCircle(u?318:292,t+10,10)};c(i);let o=i;this.add.zone(305,t+10,50,24).setInteractive().on("pointerdown",()=>{o=!o,c(o),n(o)})}addOptionSelector(e,t,s,i,n,a){this.add.text(e,t,s,{fontSize:"14px",fontFamily:"Arial",color:"#CAF0F8"});let r=i.indexOf(n);const c=80,o=140,u=[];i.forEach((h,f)=>{const d=o+f*(c+10),S=this.add.graphics();this.add.text(d+c/2,t+2,h,{fontSize:"12px",fontFamily:"Arial",color:"#FFFFFF"}).setOrigin(.5),u.push(S),this.add.zone(d+c/2,t+2,c,24).setInteractive().on("pointerdown",()=>{r=f,a(i[f]),p()})});const p=()=>{u.forEach((h,f)=>{h.clear();const d=o+f*(c+10);h.fillStyle(f===r?46296:13670,1),h.fillRoundedRect(d,t-10,c,24,8)})};p()}addButton(e,t,s,i){const n=this.add.graphics();n.fillStyle(30646,.9),n.fillRoundedRect(e-65,t-18,130,36,10),this.add.text(e,t,s,{fontSize:"14px",fontFamily:"Arial",color:"#FFFFFF"}).setOrigin(.5),this.add.zone(e,t,130,36).setInteractive().on("pointerdown",i)}}class le extends y.Scene{constructor(){super({key:"ResultsScene"}),this.players=[],this.elapsedTime=0}init(e){this.players=e.players||[],this.mode=e.mode||"classic",this.elapsedTime=e.elapsedTime||0}create(){const{width:e,height:t}=this.cameras.main,s=this.add.graphics();s.fillGradientStyle(13670,13670,30646,46296,1),s.fillRect(0,0,e,t),this.createConfetti(e,t);const i=this.players.find(o=>!o.isBot),n=i?this.getPositionText(i.finishPosition):"";this.add.text(e/2,60,"RACE COMPLETE!",{fontSize:"32px",fontFamily:"Arial",color:"#FFD700",stroke:"#003566",strokeThickness:4}).setOrigin(.5),i&&this.add.text(e/2,110,`You finished ${n}!`,{fontSize:"24px",fontFamily:"Arial",color:i.finishPosition===1?"#FFD700":"#FFFFFF"}).setOrigin(.5);const a=170,r=50;this.players.slice(0,8).forEach((o,u)=>{const p=a+u*r,h=!o.isBot,f=this.add.graphics();f.fillStyle(h?16766720:13670,h?.3:.5),f.fillRoundedRect(30,p-15,e-60,40,8),this.add.text(50,p,`#${o.finishPosition}`,{fontSize:"18px",fontFamily:"Arial",color:u===0?"#FFD700":u===1?"#C0C0C0":u===2?"#CD7F32":"#FFFFFF",fontStyle:"bold"}).setOrigin(0,.5);const d=this.add.graphics();d.fillStyle(_[o.skinIndex]||16777215,1),d.fillCircle(95,p,8),this.add.text(115,p,o.name,{fontSize:"16px",fontFamily:"Arial",color:h?"#FFE66D":"#CAF0F8"}).setOrigin(0,.5),this.add.text(250,p,this.formatTime(o.finishTime),{fontSize:"14px",fontFamily:"Arial",color:"#90E0EF"}).setOrigin(0,.5),this.add.text(340,p,`${o.score}`,{fontSize:"14px",fontFamily:"Arial",color:"#FFD700",fontStyle:"bold"}).setOrigin(1,.5)});const c=a+Math.min(this.players.length,8)*r+20;this.add.text(e/2,c,`Mode: ${this.mode} | Time: ${this.formatTime(this.elapsedTime)}`,{fontSize:"14px",fontFamily:"Arial",color:"#90E0EF"}).setOrigin(.5),this.createButton(e/2,c+60,"Play Again",()=>{this.scene.start("GameScene",{mode:this.mode})}),this.createButton(e/2,c+120,"Main Menu",()=>{this.scene.start("MenuScene")}),C.getInstance().playSfx("win")}createButton(e,t,s,i){const n=this.add.graphics();n.fillStyle(30646,.9),n.fillRoundedRect(e-100,t-22,200,44,12),n.lineStyle(2,13299960,1),n.strokeRoundedRect(e-100,t-22,200,44,12),this.add.text(e,t,s,{fontSize:"18px",fontFamily:"Arial",color:"#FFFFFF"}).setOrigin(.5),this.add.zone(e,t,200,44).setInteractive().on("pointerdown",i)}createConfetti(e,t){const s=[16739179,5164484,16770669,9822675,15958401,11179738];for(let i=0;i<40;i++){const n=this.add.rectangle(y.Math.Between(0,e),y.Math.Between(-50,-10),y.Math.Between(4,8),y.Math.Between(4,8),y.Utils.Array.GetRandom(s));this.tweens.add({targets:n,y:t+20,x:n.x+y.Math.Between(-50,50),angle:y.Math.Between(0,360),duration:y.Math.Between(2e3,4e3),repeat:-1,delay:y.Math.Between(0,2e3)})}}getPositionText(e){return e===1?"1st":e===2?"2nd":e===3?"3rd":`${e}th`}formatTime(e){const t=Math.floor(e/60),s=Math.floor(e%60),i=Math.floor(e%1*100);return`${t}:${s.toString().padStart(2,"0")}.${i.toString().padStart(2,"0")}`}}const oe={type:y.AUTO,parent:"game-container",width:390,height:844,scale:{mode:y.Scale.FIT,autoCenter:y.Scale.CENTER_BOTH},backgroundColor:"#87CEEB",physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}},scene:[X,U,ie,le,ae,re],render:{pixelArt:!1,antialias:!0},input:{activePointers:3}};new y.Game(oe);"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./service-worker.js").catch(()=>{})});
